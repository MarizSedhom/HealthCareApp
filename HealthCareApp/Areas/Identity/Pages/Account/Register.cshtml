@page
@model RegisterModel
@{
    ViewData["Title"] = "Register";
    int i = 0;
    i = 1;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedConnect | Join Our Healthcare Community</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-blue: #A6AEBF;
            --dark-blue: #223249;
            --patient-green: #34a853;
            --doctor-blue: #C5D3E8;
            --white: #ffffff;
            --gray: #f5f5f5;
            --dark-gray: #757575;
            --border-color: #ddd;
            --google-color:#223249;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--gray);
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
        }

        .logo-reg {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

            .logo-reg i {
                font-size: 2.5rem;
                color: var(--dark-blue);
                margin-right: 15px;
                animation: pulse 2s infinite;
            }

            logo-pulse{
            font-size: 2.5rem;
            color: var(--dark-blue);
            margin-right: 15px;
            animation: pulse 2s infinite;
            }

            .logo-reg h1 {
                font-size: 2.2rem;
                color: var(--dark-blue);
                font-weight: 700;
            }

        .tagline {
            font-size: 1.2rem;
            color: var(--dark-gray);
            margin-bottom: 30px;
        }

        .registration-container {
            display: flex;
            background-color: var(--white);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            position: relative;
        }

        .illustration-side {
            flex: 1;
            background: linear-gradient(135deg, var(--doctor-blue), var(--dark-blue));
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: var(--white);
            position: relative;
            overflow: hidden;
            transition: all 0.5s ease;
        }


            .illustration-side.patient-mode {
                background: linear-gradient(135deg, var(--patient-green), #D0E8C5);
            }

            .illustration-side::before {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M30,50 Q50,30 70,50 T90,50" fill="none" stroke="white" stroke-width="2" stroke-opacity="0.1"/></svg>');
                background-size: 100px 100px;
                opacity: 0.3;
            }

            .illustration-side h2 {
                font-size: 1.8rem;
                margin-bottom: 20px;
                z-index: 1;
                text-align: center;
            }

            .illustration-side p {
                margin-bottom: 30px;
                text-align: center;
                z-index: 1;
                font-size: 1rem;
            }

        .medical-icons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            z-index: 1;
            margin-bottom: 20px;
        }

            .medical-icons i {
                font-size: 1.8rem;
                background-color: rgba(255, 255, 255, 0.2);
                width: 50px;
                height: 50px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: transform 0.3s;
            }

        .stats {
            margin-top: 20px;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 12px;
            border-radius: 8px;
            z-index: 1;
            font-size: 0.9rem;
        }

        .form-side {
            flex: 2;
            padding: 30px;
            display: flex;
            flex-direction: column;
        }

        .form-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .role-selection {
            display: flex;
            margin-bottom: 20px;
            gap: 10px;
        }

        .role-option {
            flex: 1;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

            .role-option:hover {
                border-color: var(--dark-blue);
            }

            .role-option.selected {
                border-color: var(--dark-blue);
                background-color: var(--light-blue);
            }

            .role-option i {
                font-size: 1.5rem;
                margin-bottom: 8px;
                color: var(--dark-blue);
            }

            .role-option h3 {
                font-size: 1rem;
                margin-bottom: 4px;
            }

            .role-option p {
                font-size: 0.8rem;
                color: var(--dark-gray);
            }

        .form-fields-container {
            display: flex;
            gap: 20px;
            flex: 1;
        }

        .common-fields {
            flex: 1;
        }

        .role-specific-fields {
            width: 300px;
            background-color: rgba(240, 240, 240, 0.5);
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s;
            /* opacity: 0; */
            display: none;
            height: 0;
            overflow: hidden;
        }

            .role-specific-fields.active {
                display: block;
                height: auto;
            }

        .form-group {
            margin-bottom: 15px;
            position: relative;
        }

            .form-group label {
                display: block;
                margin-bottom: 6px;
                font-weight: 600;
                color: var(--dark-blue);
                font-size: 0.9rem;
            }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

            .form-control:focus {
                border-color: var(--dark-blue);
                box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2);
                outline: none;
            }

            .form-control.with-icon {
                padding-left: 35px;
            }

        .input-icon {
            position: absolute;
            left: 12px;
            top: 35px;
            color: var(--dark-gray);
            font-size: 0.9rem;
        }

        .password-strength {
            margin-top: 5px;
            height: 4px;
            background-color: #eee;
            border-radius: 4px;
            overflow: hidden;
        }

        .strength-meter {
            height: 100%;
            width: 0%;
            background-color: #ff0000;
            transition: all 0.3s;
        }

        .strength-text {
            font-size: 0.7rem;
            color: var(--dark-gray);
            margin-top: 4px;
        }

        .specialty-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-top: 8px;
        }

        .specialty-option {
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.8rem;
        }

            .specialty-option:hover {
                background-color: var(--light-blue);
            }

            .specialty-option.selected {
                background-color: var(--dark-blue);
                color: white;
                border-color: var(--dark-blue);
            }

        .progress-container {
            margin: 20px 0;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.8rem;
        }

        .progress-bar {
            height: 8px;
            background-color: #eee;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            width: 0%;
            background-color: var(--medical-green);
            transition: width 0.5s;
        }

        .btn {
            display: inline-block;
            padding: 12px;
            /* background-color: var(--dark-blue); */
            background: linear-gradient(to right, var(--dark-blue), #3a4d6d);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            width: 100%;
        }


        /* Doctor mode hover */
        .illustration-side:not(.patient-mode) + .form-side .btn:hover {
            background: linear-gradient(to right, #C5D3E8, var(--dark-blue));
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .patient-mode + .form-side .btn:hover {
            background: linear-gradient(to right, #D0E8C5, var(--dark-blue));
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }


        .btn i {
            margin-right: 6px;
        }

        .terms {
            margin-top: 15px;
            font-size: 0.8rem;
            color: var(--dark-gray);
            text-align: center;
        }

            .terms a {
                color: var(--dark-blue);
                text-decoration: none;
            }

        .external-auth-section {
            margin-top: 40px;
            padding: 25px;
            background: linear-gradient(110deg, #C5D3E8 0%, #34a853 30%, #223249 100%);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .external-auth-title {
            text-align: center;
            color: white;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
        }

        .external-auth-providers {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .btn-external {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px;
            border: 2px solid var(--google-color);
            border-radius: 8px;
            background: var(--white);
            color: var(--google-color);
            font-weight: 600;
            transition: all 0.3s ease;
        }

            .btn-external:hover {
                transform: translateY(-2px);
                border-color: #34a853;
                color: #34a853;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            }

            .btn-external i {
                margin-right: 10px;
                font-size: 1.2rem;
            }


        .btn-facebook {
            color: #1877F2;
        }

        .btn-microsoft {
            color: #00A4EF;
        }

        .btn-twitter {
            color: #1DA1F2;
        }

        .no-external-warning {
            text-align: center;
            color: var(--dark-gray);
            font-size: 0.9rem;
        }

            .no-external-warning a {
                color: var(--dark-blue);
                text-decoration: none;
                font-weight: 600;
            }
        @@keyframes pulse {
            0%

        {
            transform: scale(1);
        }

        50% {
            transform: scale(1.1);
        }

        100% {
            transform: scale(1);
        }

        }

        @@media (max-width: 768px) {
            .registration-container

        {
            flex-direction: column;
        }

        .illustration-side {
            padding: 25px 15px;
        }

        .form-side {
            padding: 25px 15px;
        }

        .form-fields-container {
            flex-direction: column;
        }

        .role-specific-fields {
            width: 100%;
            margin-top: 15px;
        }

        .role-selection {
            flex-direction: column;
        }

        }


    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-reg">
				<i class="fas fa-heartbeat  3x logo-pulse-" style="display: inline-block"></i>
                <h1>MedConnect</h1>
            </div>
            <p class="tagline">Bridging the gap between doctors and patients for better healthcare</p>
        </header>

        <div class="registration-container">
            <div class="illustration-side patient-mode" id="illustration-side">
                <h2>Your Health Journey Starts Here</h2>
                <p>Join our growing community of healthcare professionals and patients</p>

                <div class="medical-icons">
                    <i class="fas fa-user-md"></i>
                    <i class="fas fa-stethoscope"></i>
                    <i class="fas fa-heart"></i>
                    <i class="fas fa-pills"></i>
                </div>

                <div class="stats">
                    <p><i class="fas fa-users"></i> 4,382 doctors and 92,157 patients connected</p>
                </div>
            </div>

            <div class="form-side">
                <div class="form-content">
                    <form id="registerForm" asp-route-returnUrl="@Model.ReturnUrl" enctype="multipart/form-data" method="post">
                        <div asp-validation-summary="All" class="validation-summary-errors text-danger" role="alert" ></div>

                        <div class="role-selection">
                            <div class="role-option selected" data-role="patient" id="patientRoleOption">
                                <i class="fas fa-user"></i>
                                <h3>I'm a Patient</h3>
                                <p>Looking for healthcare services</p>
                                <input type="radio" name="Input.UserType" id="patientRadio" value="Patient"  style="display: none;">
                            </div>
                            <div class="role-option" data-role="doctor" id="doctorRoleOption">
                                <i class="fas fa-user-md"></i>
                                <h3>I'm a Doctor</h3>
                                <p>Healthcare professional</p>
                                <input type="radio" name="Input.UserType" id="doctorRadio" value="Doctor" style="display: none;">
                            </div>
                        </div>

                        <div class="form-fields-container">
                            <div class="common-fields">
                                <!-- Common Fields -->
                                <div class="form-group">
                                    <label asp-for="Input.FirstName"></label>
                                    <i class="fas fa-user input-icon"></i>
                                    <input asp-for="Input.FirstName" class="form-control with-icon" placeholder="Enter your first name" />
                                    <span asp-validation-for="Input.FirstName" class="text-danger"></span>
                                </div>

                                <div class="form-group">
                                    <label asp-for="Input.LastName"></label>
                                    <i class="fas fa-user input-icon"></i>
                                    <input asp-for="Input.LastName" class="form-control with-icon" placeholder="Enter your last name" />
                                    <span asp-validation-for="Input.LastName" class="text-danger"></span>
                                </div>

                                <div class="form-group">
                                    <label asp-for="Input.Email"></label>
                                    <i class="fas fa-envelope input-icon"></i>
                                    <input asp-for="Input.Email" class="form-control with-icon" placeholder="Enter your email" />
                                    <span asp-validation-for="Input.Email" class="text-danger"></span>
                                </div>

                                <div class="form-group">
                                    <label asp-for="Input.Password"></label>
                                    <i class="fas fa-lock input-icon"></i>
                                    <input asp-for="Input.Password" class="form-control with-icon" placeholder="Create a password" />
                                    <div class="password-strength">
                                        <div class="strength-meter" id="strength-meter"></div>
                                    </div>
                                    <div class="strength-text" id="strength-text">Password strength: Weak</div>
                                    <span asp-validation-for="Input.Password" class="text-danger"></span>
                                </div>

                                <div class="form-group">
                                    <label asp-for="Input.ConfirmPassword"></label>
                                    <i class="fas fa-lock input-icon"></i>
                                    <input asp-for="Input.ConfirmPassword" class="form-control with-icon" placeholder="Confirm your password" />
                                    <span asp-validation-for="Input.ConfirmPassword" class="text-danger"></span>
                                </div>

                                <div class="form-group">
                                    <label asp-for="Input.DateOfBirth"></label>
                                    <i class="fas fa-calendar-alt input-icon"></i>
                                    <input asp-for="Input.DateOfBirth" class="form-control with-icon" />
                                    <span asp-validation-for="Input.DateOfBirth" class="text-danger"></span>
                                </div>

                                <div class="form-group">
                                    <label asp-for="Input.Gender"></label>
                                    <select asp-for="Input.Gender" class="form-control">
                                        <option value="">-- Select Gender --</option>
                                        <option value="0">Male</option>
                                        <option value="1">Female</option>
                                    </select>
                                    <span asp-validation-for="Input.Gender" class="text-danger"></span>
                                </div>
                            </div>

                            <!-- Role Specific Fields -->
                            <div>
                                <div id="patientFields" class="role-specific-fields active">
                                    <div class="form-group">
                                        <label asp-for="Input.PhoneNumber"></label>
                                        <i class="fas fa-phone input-icon"></i>
                                        <input asp-for="Input.PhoneNumber" class="form-control with-icon" />
                                        <span asp-validation-for="Input.PhoneNumber" class="text-danger"></span>
                                    </div>

                                    <div class="form-group">
                                        <label asp-for="Input.EmergencyContact"></label>
                                        <textarea asp-for="Input.EmergencyContact" class="form-control" rows="2"></textarea>
                                        <span asp-validation-for="Input.EmergencyContact" class="text-danger"></span>
                                    </div>

                                    <div class="form-group">
                                        <label asp-for="Input.MedicalHistory"></label>
                                        <textarea asp-for="Input.MedicalHistory" class="form-control" rows="4"></textarea>
                                        <span asp-validation-for="Input.MedicalHistory" class="text-danger"></span>
                                    </div>
                                </div>

                                <div id="doctorFields" class="role-specific-fields">
                                    <div class="form-group">
                                        <label asp-for="Input.Title"></label>
                                        <select asp-for="Input.Title" class="form-control" asp-items="@Html.GetEnumSelectList<Title>()">
                                            <option value="">-- Select Title --</option>
                                        </select>
                                        <span asp-validation-for="Input.Title" class="text-danger"></span>
                                    </div>

                                    <div class="form-group">
                                        <label asp-for="Input.Description"></label>
                                        <textarea asp-for="Input.Description" class="form-control" rows="3"></textarea>
                                        <span asp-validation-for="Input.Description" class="text-danger"></span>
                                    </div>

                                    <div class="form-group">
                                        <label asp-for="Input.ExperienceYears"></label>
                                        <input asp-for="Input.ExperienceYears" class="form-control" />
                                        <span asp-validation-for="Input.ExperienceYears" class="text-danger"></span>
                                    </div>

                                    <div class="form-group">
                                        <label asp-for="Input.SpecializationId"></label>
                                        <select asp-for="Input.SpecializationId" asp-items="Model.Specializations" class="form-control">
                                            <option value="">-- Select Specialization --</option>
                                        </select>
                                        <span asp-validation-for="Input.SpecializationId" class="text-danger"></span>
                                    </div>
                                    <div class="form-group">
                                        <label asp-for="Input.SubSpecializationId"></label>
                                        <select asp-for="Input.SubSpecializationId" class="form-control">
                                            <option value="">-- Select SubSpecialization --</option>
                                        </select>
                                        <span asp-validation-for="Input.SubSpecializationId" class="text-danger"></span>
                                    </div>
                                    <!-- Fees && waiting time -->
                                    <div class="form-group mb-3">
                                        <label asp-for="Input.WaitingTimeInMinutes" class="form-label fw-bold"></label>
                                        <div class="input-group">
                                            <input asp-for="Input.WaitingTimeInMinutes" class="form-control" />
                                            <span class="input-group-text">mins</span>
                                        </div>
                                        <span asp-validation-for="Input.WaitingTimeInMinutes" class="text-danger small"></span>
                                    </div>
                                    <div class="form-group mb-3">
                                        <label asp-for="Input.Fees" class="form-label fw-bold"></label>
                                        <div class="input-group">
                                            <input asp-for="Input.Fees" class="form-control" />
                                            <span class="input-group-text">LE</span>
                                        </div>
                                        <span asp-validation-for="Input.Fees" class="text-danger small"></span>
                                    </div>
                                    <!--doctor files -->

                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="form-group mb-3">
                                                <label asp-for="Input.doctorVerificationFile" class="form-label fw-bold"></label>
                                                <input asp-for="Input.doctorVerificationFile" class="form-control" accept=".pdf">
                                                <span asp-validation-for="Input.doctorVerificationFile" class="text-danger small"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="btn" id="registerSubmit"><i class="fas fa-user-plus"></i> Register as Patient</button>
                    </form>
                </div>

                <div class="terms">
                    By joining, you agree to our <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>.
                    <p>MedConnect follows HIPAA compliance standards.</p>
                </div>
            </div>
        </div>

        <div class="external-auth-section">
            <h1 class="external-auth-title">Quick Sign Up With</h1>
            <div class="external-auth-providers">
                @{
                    if ((Model.ExternalLogins?.Count ?? 0) == 0)
                    {
                        <div class="no-external-warning">
                            <p>
                                There are no external authentication services configured. See this
                                <a href="https://go.microsoft.com/fwlink/?LinkID=532715">article</a>.
                            </p>
                        </div>
                    }
                    else
                    {
                        <form id="external-account" asp-page="./ExternalLogin" asp-route-returnUrl="@Model.ReturnUrl" method="post" class="d-flex justify-content-center">
                            @foreach (var provider in Model.ExternalLogins!)
                            {
                                <button type="submit"
                                        class="btn-external @($"btn-{provider.Name.ToLower()}")"
                                        name="provider"
                                        value="@provider.Name"
                                        title="Register using your @provider.DisplayName account">
                                    <i class="fab fa-@(provider.Name.ToLower())"></i>
                                    Continue with @provider.DisplayName
                                </button>
                            }
                        </form>
                    }
                }
            </div>
        </div>
    </div>

    @section Scripts {
        <partial name="_ValidationScriptsPartial" />
        <script>
            // Role selection functionality
             document.addEventListener("DOMContentLoaded", function () {
                       const roleOptions = document.querySelectorAll('.role-option');
            const patientFields = document.getElementById('patientFields');
            const doctorFields = document.getElementById('doctorFields');
            const patientRadio = document.getElementById('patientRadio');
            const doctorRadio = document.getElementById('doctorRadio');
            const registerSubmit = document.getElementById('registerSubmit');
            const illustrationSide = document.getElementById('illustration-side');

            roleOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const role = this.dataset.role;
                    roleOptions.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');

                    if (role === 'patient') {
                        patientFields.classList.add('active');
                        doctorFields.classList.remove('active');
                        patientRadio.checked = true;
                        registerSubmit.innerHTML = '<i class="fas fa-user-plus"></i> Register as Patient';
                        illustrationSide.classList.add('patient-mode');
                    } else {
                        patientFields.classList.remove('active');
                        doctorFields.classList.add('active');
                        doctorRadio.checked = true;
                        registerSubmit.innerHTML = '<i class="fas fa-user-md"></i> Register as Doctor';
                        illustrationSide.classList.remove('patient-mode');
                    }
                });
            });

            // Password strength meter
            const password = document.getElementById('Input_Password');
            const strengthMeter = document.getElementById('strength-meter');
            const strengthText = document.getElementById('strength-text');

            password.addEventListener('input', function() {
                const strength = calculatePasswordStrength(this.value);
                updateStrengthMeter(strength);
            });

            function calculatePasswordStrength(password) {
                let strength = 0;
                if (password.length > 0) strength += 1;
                if (password.length >= 8) strength += 1;
                if (password.length >= 12) strength += 1;
                if (/[A-Z]/.test(password)) strength += 1;
                if (/[0-9]/.test(password)) strength += 1;
                if (/[^A-Za-z0-9]/.test(password)) strength += 1;
                return Math.min(strength, 5);
            }

            function updateStrengthMeter(strength) {
                const colors = ['#ff0000', '#ff5e00', '#ffbb00', '#a0ff00', '#00ff00'];
                const messages = ['Very Weak', 'Weak', 'Moderate', 'Strong', 'Very Strong'];
                const width = (strength / 5) * 100;
                strengthMeter.style.width = `${width}%`;
                strengthMeter.style.backgroundColor = colors[strength - 1] || '#ff0000';
                strengthText.textContent = `Password strength: ${messages[strength - 1] || 'Very Weak'}`;
            }

             $("#Input_SpecializationId").change(function() {
                var selectedSpecialization = $(this).val();
                var subSpecializationsDropdown = $("#Input_SubSpecializationId");

                subSpecializationsDropdown.empty();

                if (selectedSpecialization) {
                    $.ajax({
                        url: '/SubSpecialization/GetSubSpecialization',
                        type: 'GET',
                        data: { SelectedSpecialization: selectedSpecialization },
                        success: function(response) {
                            $.each(response, function(index, subSpecialization) {
                                subSpecializationsDropdown.append(
                                    $('<option></option>')
                                        .val(subSpecialization.id)
                                        .text(subSpecialization.name)
                                );
                            });
                        },
                        error: function(xhr, status, error) {
                            console.error("Error fetching sub-specializations:", error);
                        }
                    });
                }
            });
                       
             });
  
        </script>
    }
</body>
</html>